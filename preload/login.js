module.exports=function(){const{ipcRenderer:e}=require("electron"),o=require("./qrcode.js"),n=async()=>{const n=await new Promise(e=>{const o=new MutationObserver(()=>{const n=document.querySelector("#ddlogin-iframe");n&&(o.disconnect(),e(n.contentWindow))});o.observe(document.querySelector("#ddlogin"),{childList:!0})}),r=await new Promise(e=>{const o=setInterval(()=>{n.currentCode&&(e(n.currentCode),clearInterval(o))},1e3)});(e=>{const o=e.document.querySelector(".login_qrcode_refresh");new MutationObserver(()=>{"block"==o.style.display&&top.location.reload()}).observe(o,{attributes:!0})})(n);const t=new URL(n.GOTO).searchParams,c=t.get("appid"),s=t.get("redirect_uri"),i=`https://oapi.dingtalk.com/connect/qrcommit?showmenu=false&code=${r}&appid=${c}&redirect_uri=${encodeURIComponent(s)}`,d=await o.generatePromise(i,{small:!0});return console.log(i),e.send("log",`\n请使用学习强国APP扫码登录:\n${d}\n`),e.send("log",`或者使用学习强国APP打开此链接:\n${i}\n`),i};return{onLogin:()=>{document.querySelectorAll(".header, .redflagbox, .footer").forEach(e=>{e.style.display="none"}),e.sendSync("isHeadless")&&n()},isLoggedIn:()=>document.cookie.includes("token=")}}();